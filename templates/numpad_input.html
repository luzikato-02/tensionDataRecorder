<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 0;
    padding: 0;
  }

  #container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }

  #number-form {
    margin-bottom: 10px;
  }

  .number-button {
    width: 50px;
    height: 50px;
    margin: 5px;
    font-size: 18px;
  }

  #recorded-numbers {
    margin-top: 20px;
  }
</style>
<title>Number Recorder</title>
</head>
<body>
<div id="container">
  <h1>Number Recorder</h1>
  
  <div>
    <button onclick="prevID()">Previous ID</button>
    <span id="current-id">1</span>
    <button onclick="nextID()">Next ID</button>
  </div>
  
  <form id="number-form">
    <label for="number">Enter Number: </label>
    <input type="number" id="number" name="number" required>
  </form>
  
  <div>
    <button class="number-button" onclick="appendNumber(1)">1</button>
    <button class="number-button" onclick="appendNumber(2)">2</button>
    <button class="number-button" onclick="appendNumber(3)">3</button>
  </div>
  <div>
    <button class="number-button" onclick="appendNumber(4)">4</button>
    <button class="number-button" onclick="appendNumber(5)">5</button>
    <button class="number-button" onclick="appendNumber(6)">6</button>
  </div>
  <div>
    <button class="number-button" onclick="appendNumber(7)">7</button>
    <button class="number-button" onclick="appendNumber(8)">8</button>
    <button class="number-button" onclick="appendNumber(9)">9</button>
  </div>
  <div>
    <button class="number-button" onclick="clearNumber()">Clear</button>
    <button class="number-button" onclick="appendNumber(0)">0</button>
    <button class="number-button" onclick="backspaceNumber()">&#9003;</button>
  </div>
  
  <button onclick="recordNumber()">Submit</button>
  <button onclick="finishRecording()">Finish</button>

  <div id="recorded-numbers">
    <h2>Recorded Numbers for ID <span id="displayed-id">1</span>:</h2>
    <ul id="numbers-list"></ul>
  </div>
</div>

<script>
  let currentID = 1;
  let data = {};

  function updateIDDisplay() {
    const currentIDElement = document.getElementById('current-id');
    currentIDElement.textContent = currentID;
    document.getElementById('displayed-id').textContent = currentID;
    displayRecordedNumbers();
  }

  function prevID() {
    if (currentID > 1) {
      currentID--;
      updateIDDisplay();
    }
  }

  function nextID() {
    if (currentID < 84) {
      currentID++;
      updateIDDisplay();
    }
  }

  function appendNumber(num) {
    const numberInput = document.getElementById('number');
    numberInput.value += num;
  }

  function backspaceNumber() {
    const numberInput = document.getElementById('number');
    numberInput.value = numberInput.value.slice(0, -1);
  }

  function clearNumber() {
    const numberInput = document.getElementById('number');
    numberInput.value = '';
  }

  function recordNumber() {
    const numberInput = document.getElementById('number');
    
    const number = numberInput.value;
    
    data[currentID] = [number]; // Overwrite previous number with new one
    
    console.log(data);
    
    numberInput.value = '';
    displayRecordedNumbers();
  }

  function finishRecording() {
    let csvContent = "data:text/csv;charset=utf-8,ID,Numbers\n";
    Object.keys(data).forEach(key => {
      const row = [key, data[key].join(",")];
      csvContent += row.join(",") + "\n";
    });

    const encodedUri = encodeURI(csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", encodedUri);
    link.setAttribute("download", "recorded_data.csv");
    document.body.appendChild(link); // Required for Firefox
    link.click(); // Trigger the link click

    // Clear the stored data after download
    data = {};

    displayRecordedNumbers();
  }

  function displayRecordedNumbers() {
    const numbersList = document.getElementById('numbers-list');
    numbersList.innerHTML = '';

    if (data[currentID]) {
      data[currentID].forEach(number => {
        const listItem = document.createElement('li');
        listItem.textContent = number;
        numbersList.appendChild(listItem);
      });
    }
  }
</script>
</body>
</html>
