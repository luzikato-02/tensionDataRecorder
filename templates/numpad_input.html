<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 0;
    padding: 0;
  }

  #container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }

  #number-form {
    margin: 20px 0;
  }

  .number-button {
    width: 50px;
    height: 50px;
    margin: 5px;
    font-size: 18px;
  }

  .submit-buttons {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 5px;
    width: 100%;
    margin-top: 10px;
  }

  .submit-button {
    font-size: 18px;
    padding: 12px 0;
  }

/* Modify the font size and add padding to the Submit, Finish, and Delete buttons */
.submit-button,
.delete-button {
  font-size: 14px; /* Adjust the font size as needed */
  padding: 8px 12px; /* Adjust the padding to create space around the text */
  margin: 5px;
}


  #recorded-numbers {
    margin-top: 20px;
  }

  .arrow-button {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
  }

  #current-id {
    font-size: 24px;
    margin: 0 10px;
  }

  .delete-button {
    background-color: #FF0000;
    color: white;
  }

  #tension-type {
    font-size: 24px;
    margin: 10px;
  }

  /* Added styles for tension type buttons */
  .tension-type-button {
    width: 130px;
    height: 50px;
    margin: 5px;
    font-size: 14px;
  }

  .tension-type-button {
    width: 130px;
    height: 50px;
    margin: 5px;
    font-size: 14px;
  }

  /* Added styles for displayed tension type */
  #displayed-tension-type {
    font-size: 18px;
    margin-top: 5px;
  }

  .numbers-container {
    display: flex;
    justify-content: space-between;
    margin: 20px;
  }

  .tension-list {
    flex: 1;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    background-color: #f9f9f9;
    text-align: left;
  }

  .tension-list h3 {
    margin: 0;
    font-size: 18px;
  }

  .tension-list ul {
    list-style-type: none;
    padding: 0;
    margin: 10px 0;
  }

</style>
<title>Tension Data Recorder</title>
</head>
<body>
<div id="container">
  <h1>Tension Data Recorder</h1>

  <div id="recorded-numbers">
    <h2>Recorded Tension for Spd No. <span id="displayed-id">1</span>:</h2>
    <div class="numbers-container">
      <div class="tension-list">
        <h3>MIN</h3>
        <ul id="min-numbers-list"></ul>
      </div>
      <div class="tension-list">
        <h3>MAX</h3>
        <ul id="max-numbers-list"></ul>
      </div>
    </div>
  </div>
  
  <div>
    <span id="label-spindle">Spd No.</span>
    <button class="arrow-button" onclick="prevID()">&#9664;</button>
    <span id="current-id">1</span>
    <button class="arrow-button" onclick="nextID()">&#9654;</button>
  </div>

  <div>
    <span id="label-tension">Tension Type</span>
    <button class="arrow-button" onclick="changeTensionType()">&#9664;</button>
    <span id="tension-type">MIN</span>
    <button class="arrow-button" onclick="changeTensionType()">&#9654;</button>
  </div>

  <form id="number-form">
    <label for="number">Enter Number: </label>
    <input type="number" id="number" name="number" required>
  </form>
  
  <div>
    <button class="number-button" onclick="appendNumber(1)">1</button>
    <button class="number-button" onclick="appendNumber(2)">2</button>
    <button class="number-button" onclick="appendNumber(3)">3</button>
  </div>
  <div>
    <button class="number-button" onclick="appendNumber(4)">4</button>
    <button class="number-button" onclick="appendNumber(5)">5</button>
    <button class="number-button" onclick="appendNumber(6)">6</button>
  </div>
  <div>
    <button class="number-button" onclick="appendNumber(7)">7</button>
    <button class="number-button" onclick="appendNumber(8)">8</button>
    <button class="number-button" onclick="appendNumber(9)">9</button>
  </div>
  <div>
    <button class="number-button" onclick="clearNumber()">C</button>
    <button class="number-button" onclick="appendNumber(0)">0</button>
    <button class="number-button" onclick="backspaceNumber()">&#9003;</button>
  </div>
  
  <div class="button-container">
    <button class="submit-button" onclick="recordNumber()">Submit</button>
    <button class="submit-button" onclick="promptFinish()">Finish</button>
    <button class="custom-button delete-button" onclick="deleteData()">Delete</button>
  </div>
  
  
</div>

<script>
  let currentID = 1;
  let currentTensionType = "MIN"; // Default tension type abbreviation
  let data = {
    "MIN": {},
    "MAX": {}
  };

  function updateIDDisplay() {
    const currentIDElement = document.getElementById('current-id');
    currentIDElement.textContent = currentID;
    document.getElementById('displayed-id').textContent = currentID;
    displayRecordedNumbers();
  }

  function changeTensionType() {
    currentTensionType = (currentTensionType === "MIN") ? "MAX" : "MIN";
    updateTensionTypeDisplay();
    displayRecordedNumbers();
  }

  function updateTensionTypeDisplay() {
    const tensionTypeElement = document.getElementById('tension-type');
    tensionTypeElement.textContent = currentTensionType;
    const displayedTensionType = document.getElementById('displayed-tension-type');
    displayedTensionType.textContent = (currentTensionType === "MIN") ? "Cord Tension" : "Winding Tension";
  }


  function prevID() {
    if (currentID > 1) {
      currentID--;
      updateIDDisplay();
    }
  }

  function nextID() {
    if (currentID < 84) {
      currentID++;
      updateIDDisplay();
    }
  }

  function appendNumber(num) {
    const numberInput = document.getElementById('number');
    numberInput.value += num;
  }

  function backspaceNumber() {
    const numberInput = document.getElementById('number');
    numberInput.value = numberInput.value.slice(0, -1);
  }

  function clearNumber() {
    const numberInput = document.getElementById('number');
    numberInput.value = '';
  }

  function recordNumber() {
    const numberInput = document.getElementById('number');
    const number = numberInput.value;

    if (!data[currentTensionType][currentID]) {
      data[currentTensionType][currentID] = [];
    }
    
    data[currentTensionType][currentID].push(number);
    numberInput.value = '';
    displayRecordedNumbers();
  }

  function promptFinish() {
    const machineNumber = prompt("Enter machine number:");
    const operator = prompt("Enter operator:");
    
    if (machineNumber !== null && operator !== null) {
      const confirmation = confirm("Are you sure you want to finish? This will erase the stored data.");
      if (confirmation) {
        finishRecording(machineNumber, operator);
      }
    }
  }

  function finishRecording(machineNumber, operator) {
    let csvContent = "Machine Number,Operator,Spindle Number,MIN,MAX\n";

    for (let id in data["MIN"]) {
      const cordTension = data["MIN"][id].join(",");
      const windingTension = data["MAX"][id] ? data["MAX"][id].join(",") : "";
      csvContent += `${machineNumber},${operator},${id},${cordTension},${windingTension}\n`;
    }

    const encodedUri = encodeURI(csvContent);
    const link = document.createElement("a");
    link.setAttribute("href", "data:text/csv;charset=utf-8," + encodedUri);
    link.setAttribute("download", "recorded_data.csv");
    document.body.appendChild(link);
    link.click();

    data = {
      "MIN": {},
      "MAX": {}
    };

    displayRecordedNumbers();
  }

  function deleteData() {
    delete data[currentTensionType][currentID];
    displayRecordedNumbers();
  }

  function recordNumber() {
    const numberInput = document.getElementById('number');
    const number = numberInput.value;

    if (!data[currentTensionType][currentID]) {
      data[currentTensionType][currentID] = [];
    }
    
    data[currentTensionType][currentID].push(number);
    numberInput.value = '';
    displayRecordedNumbers();
  }

  function displayRecordedNumbers() {
    const minNumbersList = document.getElementById('min-numbers-list');
    const maxNumbersList = document.getElementById('max-numbers-list');

    minNumbersList.innerHTML = '';
    maxNumbersList.innerHTML = '';

    if (data["MIN"][currentID]) {
      data["MIN"][currentID].forEach(number => {
        const listItem = document.createElement('li');
        listItem.textContent = number;
        minNumbersList.appendChild(listItem);
      });
    }

    if (data["MAX"][currentID]) {
      data["MAX"][currentID].forEach(number => {
        const listItem = document.createElement('li');
        listItem.textContent = number;
        maxNumbersList.appendChild(listItem);
      });
    }
  }
</script>
</body>
</html>
